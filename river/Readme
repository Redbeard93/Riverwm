# RiverWM 环境变量完全配置指南

## 一、核心问题与原理

### 1.1 问题现象
在 RiverWM 中设置 `XDG_CURRENT_DESKTOP=river` 环境变量后，从终端检查该变量仍然显示为空。

### 1.2 根本原因：Unix 环境变量继承模型

#### 基本原则
1. **单向继承**：环境变量只能从父进程传递给子进程，不能反向传播
2. **执行时确定**：环境变量在进程创建时确定，之后运行中的进程无法被修改
3. **进程隔离**：一个进程无法修改另一个运行中进程的环境变量


TTY Shell
↓ 继承环境
RiverWM 主进程
↓ 继承环境
子进程（应用程序）


### 1.3 常见错误理解

-- 错误：在 init.lua 中使用 os.execute("export")

os.execute("export XDG_CURRENT_DESKTOP=river")

为什么无效：

    os.execute() 创建子进程执行命令

    export 只在子 shell 进程中生效

    子进程退出后环境变量丢失

    无法修改父进程（RiverWM）的环境


# 解决办法：使用环境包装器启动river


## 第一步：创建包装器文件~/.config/river/river-wrapper


然后执行命令：`chmod +x ~/.config/river/river-wrapper`


详细解读WHY：


            exec - 进程替换命令

                功能：用新程序替换当前进程（shell本身）

                效果：新进程继承原进程的PID、文件描述符、环境变量等

                特点：执行后shell进程消失，完全被新程序替代

                对比：如果不加exec，新程序会作为shell的子进程运行

            river - 要执行的程序

                就是river窗口管理器的主程序

            "$@" - 特殊参数展开

                $@ 表示所有位置参数（positional parameters）

                加引号"$@" 确保每个参数被正确引用，防止空格/特殊字符问题

                会把脚本接收到的所有参数原封不动传递给river


## 第二步：添加到 shell 配置文件，创建别名

`echo "alias rw='~/.config/river/river-wrapper'" >> ~/.bashrc`
